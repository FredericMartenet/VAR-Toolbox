\hspace{1mm}\textcolor{matlabgreen}{\%}\textcolor{matlabgreen}{\% 0. PRELIMINARIES }\\ 
\hspace{1mm}\textcolor{matlabgreen}{\%--------------------------------------------------------------------------  }\\ 
\hspace{1mm}clear all; clear session; close all; clc \\ 
\hspace{1mm}warning off all \\ 
\hspace{1mm}addpath(genpath(\textcolor{matlabpurple}{'/Users/jambro/Google Drive/VAR-Toolbox/'})) \\ 
\hspace{1mm} \\ 
\hspace{1mm}\textcolor{matlabgreen}{\%}\textcolor{matlabgreen}{\% 1. LOAD DATA }\\ 
\hspace{1mm}\textcolor{matlabgreen}{\%**************************************************************************  }\\ 
\hspace{1mm}\textcolor{matlabgreen}{\% The data used in this example is read from an Excel file and stored in a }\\ 
\hspace{1mm}\textcolor{matlabgreen}{\% structure (DATA). }\\ 
\hspace{1mm}\textcolor{matlabgreen}{\%--------------------------------------------------------------------------  }\\ 
\hspace{1mm}\textcolor{matlabgreen}{\% Load data from US macro data set }\\ 
\hspace{1mm}[xlsdata, xlstext] = xlsread(\textcolor{matlabpurple}{'data/MACRO\_US.xlsx'},\textcolor{matlabpurple}{'Sheet1'}); \\ 
\hspace{1mm}dates = xlstext(3:end,1); \\ 
\hspace{1mm}vnames\_long = xlstext(1,2:end); \\ 
\hspace{1mm}vnames = xlstext(2,2:end); \\ 
\hspace{1mm}nvar = length(vnames); \\ 
\hspace{1mm}data   = Num2NaN(xlsdata); \\ 
\hspace{1mm}\textcolor{matlabgreen}{\% Store variables in the structure DATA }\\ 
\hspace{1mm}\textcolor{matlabblue}{for} ii=1:length(vnames) \\ 
\hspace{1mm}\hspace{5mm} DATA.(vnames\{ii\}) = data(:,ii); \\ 
\hspace{1mm}\textcolor{matlabblue}{end} \\ 
\hspace{1mm}\textcolor{matlabgreen}{\% Convert the first date to numeric }\\ 
\hspace{1mm}year = str2double(xlstext\{3,1\}(1:4)); \\ 
\hspace{1mm}quarter = str2double(xlstext\{3,1\}(6)); \\ 
\hspace{1mm}\textcolor{matlabgreen}{\% Observations }\\ 
\hspace{1mm}nobs = size(data,1); \\ 
\hspace{1mm}\textcolor{matlabgreen}{\% Transform selected variables }\\ 
\hspace{1mm}tempnames = \{\textcolor{matlabpurple}{'cpi'},\textcolor{matlabpurple}{'gdp'},\textcolor{matlabpurple}{'i1yr'}\}; \\ 
\hspace{1mm}temptreat = \{\textcolor{matlabpurple}{'logdiff'},\textcolor{matlabpurple}{'logdiff'},\textcolor{matlabpurple}{'diff'}\}; \\ 
\hspace{1mm}tempscale = [100,100,1]; \\ 
\hspace{1mm}\textcolor{matlabblue}{for} ii=1:length(tempnames) \\ 
\hspace{1mm}\hspace{5mm} aux = \{[\textcolor{matlabpurple}{'d'} tempnames\{ii\}]\}; \\ 
\hspace{1mm}\hspace{5mm} DATA.(aux\{1\}) = tempscale(ii)*XoX(DATA.(tempnames\{ii\}),1,temptreat\{ii\}); \\ 
\hspace{1mm}\textcolor{matlabblue}{end} \\ 
\hspace{1mm} \\ 
\hspace{1mm}\textcolor{matlabgreen}{\%}\textcolor{matlabgreen}{\% 2. PLOT DATA }\\ 
\hspace{1mm}\textcolor{matlabgreen}{\%**************************************************************************  }\\ 
\hspace{1mm}\textcolor{matlabgreen}{\% Select the list of variables to plot... }\\ 
\hspace{1mm}Xvnames = \{\textcolor{matlabpurple}{'gdp'},\textcolor{matlabpurple}{'cpi'},\textcolor{matlabpurple}{'unemp'},\textcolor{matlabpurple}{'vix'},\textcolor{matlabpurple}{'i1yr'},\textcolor{matlabpurple}{'ebp'}\}; \\ 
\hspace{1mm}\textcolor{matlabgreen}{\% ... and corresponding labels to be used \textcolor{matlabblue}{for} plots }\\ 
\hspace{1mm}\hspace{5mm} Xvnames\_long = \{\textcolor{matlabpurple}{'Real GDP'},\textcolor{matlabpurple}{'CPI'},\textcolor{matlabpurple}{'Unemployment'},\textcolor{matlabpurple}{'Vix Index'},\textcolor{matlabpurple}{'1-year Int. Rate'},\textcolor{matlabpurple}{'EBP'}\}; \\ 
\hspace{1mm}\hspace{5mm} Xnvar        = length(Xvnames); \\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabgreen}{\% Create matrices of variables to be used in the VAR }\\ 
\hspace{1mm}\hspace{5mm} X = nan(nobs,Xnvar); \\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabblue}{for} ii=1:Xnvar \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} X(:,ii) = DATA.(Xvnames\{ii\}); \\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabblue}{end} \\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabgreen}{\% Open a figure of the desired size and plot the selected series }\\ 
\hspace{1mm}\hspace{5mm} FigSize(26,18) \\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabblue}{for} ii=1:Xnvar \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} subplot(3,2,ii) \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} H(ii) = plot(X(:,ii),\textcolor{matlabpurple}{'LineWidth'},3,\textcolor{matlabpurple}{'Color'},cmap(1)); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} title(Xvnames\_long(ii));  \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} DatesPlot(year+(quarter-1)/4,nobs,6,\textcolor{matlabpurple}{'q'}) \textcolor{matlabgreen}{\% Set the x-axis label  }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} grid on;  \\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabblue}{end} \\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabgreen}{\% Save figure }\\ 
\hspace{1mm}\hspace{5mm} SaveFigure(\textcolor{matlabpurple}{'graphics/DATA\_GK'},1) \\ 
\hspace{1mm}\hspace{5mm} clf(\textcolor{matlabpurple}{'reset'}) \\ 
\hspace{1mm}\hspace{5mm}  \\ 
\hspace{1mm}\hspace{5mm}  \\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabgreen}{\%}\textcolor{matlabgreen}{\% 3. VAR ESTIMATION }\\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabgreen}{\%**************************************************************************  }\\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabgreen}{\% VAR estimations is achieved in two steps: (1) set the vector of endogenous  }\\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabgreen}{\% variables, the desired number of lags, and deterministic variables; (2) }\\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabgreen}{\% run the VARmdoel function. }\\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabgreen}{\%--------------------------------------------------------------------------  }\\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabgreen}{\% Select list of endogenous variables (these will be pulled from the  }\\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabgreen}{\% structure DATA, where all data is stored) and their corresponding labels  }\\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabgreen}{\% that will be used \textcolor{matlabblue}{for} plots }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} Xvnames      = \{\textcolor{matlabpurple}{'dgdp'},\textcolor{matlabpurple}{'i1yr'}\}; \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} Xvnames\_long = \{\textcolor{matlabpurple}{'Real GDP (log change)'},\textcolor{matlabpurple}{'1-year Tbill (percent)'}\}; \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} Xnvar        = length(Xvnames); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% Plot selected data }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} FigSize(26,6) \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabblue}{for} ii=1:Xnvar \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} subplot(1,2,ii) \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} H(ii) = plot(DATA.(Xvnames\{ii\}),\textcolor{matlabpurple}{'LineWidth'},3,\textcolor{matlabpurple}{'Color'},cmap(1)); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} title(Xvnames\_long(ii));  \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} DatesPlot(year+(quarter-1)/4,nobs,6,\textcolor{matlabpurple}{'q'}) \textcolor{matlabgreen}{\% Set the x-axis label  }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} grid on;  \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabblue}{end} \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} SaveFigure(\textcolor{matlabpurple}{'graphics/BIV\_DATA'},1) \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} clf(\textcolor{matlabpurple}{'reset'}) \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% Create matrices of variables to be used in the VAR }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} X = nan(nobs,Xnvar); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabblue}{for} ii=1:Xnvar \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} X(:,ii) = DATA.(Xvnames\{ii\}); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabblue}{end} \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% Make a common sample by removing NaNs }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} X = CommonSample(X); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% Set the deterministic variable in the VAR (1=constant, 2=trend) }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} det = 1; \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% Set number of lags }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} nlags = 1; \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% Estimate VAR by OLS }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} [VAR, VARopt] = VARmodel(X,nlags,det); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% Print at screen the outputs of the VARmodel \textcolor{matlabblue}{function} }\\ 
\hspace{1mm}disp(VAR) \\ 
\hspace{1mm}disp(VARopt) \\ 
\hspace{1mm}\textcolor{matlabgreen}{\% Update the VARopt structure with additional details }\\ 
\hspace{1mm}VARopt.vnames = Xvnames\_long; \\ 
\hspace{1mm}\textcolor{matlabgreen}{\% Print at screen VAR coefficients and create table  }\\ 
\hspace{1mm}[TABLE, beta] = VARprint(VAR,VARopt,2); \\ 
\hspace{1mm}\textcolor{matlabgreen}{\% Print at screen some results. Start with estimated coefficients }\\ 
\hspace{1mm}disp(VAR.F) \\ 
\hspace{1mm}disp(VAR.sigma) \\ 
\hspace{1mm}\textcolor{matlabgreen}{\% Maximum eigenvalue  }\\ 
\hspace{1mm}disp(eig(VAR.Fcomp)) \\ 
\hspace{1mm} \\ 
\hspace{1mm} \\ 
\hspace{1mm}\textcolor{matlabgreen}{\%}\textcolor{matlabgreen}{\% 4. IDENTIFICATION WITH ZERO CONTEMPORANEOUS RESTRICTIONS  }\\ 
\hspace{1mm}\textcolor{matlabgreen}{\%**************************************************************************  }\\ 
\hspace{1mm}\textcolor{matlabgreen}{\% Identification with zero contemporaneous restrictions is achieved in two  }\\ 
\hspace{1mm}\textcolor{matlabgreen}{\% steps: (1) set the identification scheme mnemonic in the structure  }\\ 
\hspace{1mm}\textcolor{matlabblue}{case} "ch"; (2) run the VARir or the  }\\ 
\hspace{1mm}\textcolor{matlabgreen}{\% VARvd functions. For the zero contemporaneous restrictions  }\\ 
\hspace{1mm}\textcolor{matlabgreen}{\% identification, consider the simple bivariate VAR estimated in the  }\\ 
\hspace{1mm}\textcolor{matlabgreen}{\% previous section. }\\ 
\hspace{1mm}\textcolor{matlabgreen}{\%--------------------------------------------------------------------------  }\\ 
\hspace{1mm} \\ 
\hspace{1mm}\textcolor{matlabgreen}{\% 4.1 Load data from Stock and Watson }\\ 
\hspace{1mm}\textcolor{matlabgreen}{\%--------------------------------------------------------------------------  }\\ 
\hspace{1mm}[xlsdata, xlstext] = xlsread(\textcolor{matlabpurple}{'data/SW2001\_Data.xlsx'},\textcolor{matlabpurple}{'Sheet1'}); \\ 
\hspace{1mm}dates = xlstext(3:end,1); \\ 
\hspace{1mm}vnames\_long = xlstext(1,2:end); \\ 
\hspace{1mm}vnames = xlstext(2,2:end); \\ 
\hspace{1mm}nvar = length(vnames); \\ 
\hspace{1mm}data   = Num2NaN(xlsdata); \\ 
\hspace{1mm}\textcolor{matlabblue}{for} ii=1:length(vnames) \\ 
\hspace{1mm}\hspace{5mm} DATA.(vnames\{ii\}) = data(:,ii); \\ 
\hspace{1mm}\textcolor{matlabblue}{end} \\ 
\hspace{1mm}year = str2double(xlstext\{3,1\}(1:4)); \\ 
\hspace{1mm}quarter = str2double(xlstext\{3,1\}(6)); \\ 
\hspace{1mm}nobs = size(data,1); \\ 
\hspace{1mm} \\ 
\hspace{1mm}\textcolor{matlabgreen}{\% 4.2 Plot series }\\ 
\hspace{1mm}\textcolor{matlabgreen}{\%--------------------------------------------------------------------------  }\\ 
\hspace{1mm}\textcolor{matlabgreen}{\% Plot all variables in DATA }\\ 
\hspace{1mm}FigSize(26,6) \\ 
\hspace{1mm}\textcolor{matlabblue}{for} ii=1:nvar \\ 
\hspace{1mm}\hspace{5mm} subplot(1,3,ii) \\ 
\hspace{1mm}\hspace{5mm} H(ii) = plot(DATA.(vnames\{ii\}),\textcolor{matlabpurple}{'LineWidth'},3,\textcolor{matlabpurple}{'Color'},cmap(1)); \\ 
\hspace{1mm}\hspace{5mm} title(vnames\_long(ii));  \\ 
\hspace{1mm}\hspace{5mm} DatesPlot(year+(quarter-1)/4,nobs,6,\textcolor{matlabpurple}{'q'}) \textcolor{matlabgreen}{\% Set the x-axis label  }\\ 
\hspace{1mm}\hspace{5mm} grid on;  \\ 
\hspace{1mm}\textcolor{matlabblue}{end} \\ 
\hspace{1mm}SaveFigure(\textcolor{matlabpurple}{'graphics/SW\_DATA'},1) \\ 
\hspace{1mm}clf(\textcolor{matlabpurple}{'reset'}) \\ 
\hspace{1mm} \\ 
\hspace{1mm}\textcolor{matlabgreen}{\% 4.3 Set up and estimate VAR }\\ 
\hspace{1mm}\textcolor{matlabgreen}{\%--------------------------------------------------------------------------  }\\ 
\hspace{1mm}\textcolor{matlabgreen}{\% Select endo }\\ 
\hspace{1mm}Xvnames      = \{\textcolor{matlabpurple}{'infl'},\textcolor{matlabpurple}{'unemp'},\textcolor{matlabpurple}{'ff'}\}; \\ 
\hspace{1mm}Xvnames\_long = \{\textcolor{matlabpurple}{'Inflation (Percent)'},\textcolor{matlabpurple}{'Unemployment (Percent)'},\textcolor{matlabpurple}{'Fed Funds (Percent)'}\}; \\ 
\hspace{1mm}Xnvar        = length(Xvnames); \\ 
\hspace{1mm}\textcolor{matlabgreen}{\% Create matrices of variables \textcolor{matlabblue}{for} the VAR }\\ 
\hspace{1mm}\hspace{5mm} X = nan(nobs,Xnvar); \\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabblue}{for} ii=1:Xnvar \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} X(:,ii) = DATA.(Xvnames\{ii\}); \\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabblue}{end} \\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabgreen}{\% Estimate VAR }\\ 
\hspace{1mm}\hspace{5mm} det = 1; \\ 
\hspace{1mm}\hspace{5mm} nlags = 4; \\ 
\hspace{1mm}\hspace{5mm} [VAR, VARopt] = VARmodel(X,nlags,det); \\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabgreen}{\% Update the VARopt structure with additional details to be used in IR  }\\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabgreen}{\% calculations and plots }\\ 
\hspace{1mm}\hspace{5mm} VARopt.vnames = Xvnames\_long; \\ 
\hspace{1mm}\hspace{5mm} VARopt.nsteps = 24; \\ 
\hspace{1mm}\hspace{5mm} VARopt.quality = 1; \\ 
\hspace{1mm}\hspace{5mm} VARopt.FigSize = [26,12]; \\ 
\hspace{1mm}\hspace{5mm} VARopt.firstdate = year+(quarter-1)/4; \\ 
\hspace{1mm}\hspace{5mm} VARopt.frequency = \textcolor{matlabpurple}{'q'}; \\ 
\hspace{1mm}\hspace{5mm} VARopt.figname= \textcolor{matlabpurple}{'graphics/SW\_'}; \\ 
\hspace{1mm}\hspace{5mm}  \\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabgreen}{\% 4.4 IMPULSE RESPONSES }\\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabgreen}{\%--------------------------------------------------------------------------  }\\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabgreen}{\% For zero contemporaneous restrictions set: }\\ 
\hspace{1mm}\hspace{5mm} VARopt.ident = \textcolor{matlabpurple}{'short'}; \\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabgreen}{\% Compute IR }\\ 
\hspace{1mm}\hspace{5mm} [IR, VAR] = VARir(VAR,VARopt); \\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabgreen}{\% Compute IR error bands }\\ 
\hspace{1mm}\hspace{5mm} [IRinf,IRsup,IRmed,IRbar] = VARirband(VAR,VARopt); \\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabgreen}{\% Plot IR }\\ 
\hspace{1mm}\hspace{5mm} VARirplot(IRbar,VARopt,IRinf,IRsup); \\ 
\hspace{1mm}\hspace{5mm}  \\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabgreen}{\% 4.5 FORECAST ERROR VARIANCE DECOMPOSITION }\\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabgreen}{\%--------------------------------------------------------------------------  }\\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabgreen}{\% Compute VD }\\ 
\hspace{1mm}\hspace{5mm} [VD, VAR] = VARvd(VAR,VARopt); \\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabgreen}{\% Compute VD error bands }\\ 
\hspace{1mm}\hspace{5mm} [VDinf,VDsup,VDmed,VDbar] = VARvdband(VAR,VARopt); \\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabgreen}{\% Plot VD }\\ 
\hspace{1mm}\hspace{5mm} VARvdplot(VDbar,VARopt); \\ 
\hspace{1mm}\hspace{5mm}  \\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabgreen}{\% 4.6 HISTORICAL DECOMPOSITION }\\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabgreen}{\%--------------------------------------------------------------------------  }\\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabgreen}{\% Compute HD }\\ 
\hspace{1mm}\hspace{5mm} [HD, VAR] = VARhd(VAR,VARopt); \\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabgreen}{\% Plot HD }\\ 
\hspace{1mm}\hspace{5mm} VARhdplot(HD,VARopt); \\ 
\hspace{1mm}\hspace{5mm}  \\ 
\hspace{1mm}\hspace{5mm}  \\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabgreen}{\%}\textcolor{matlabgreen}{\% 5. IDENTIFICATION WITH ZERO LONG-RUN RESTRICTIONS  }\\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabgreen}{\%**************************************************************************  }\\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabgreen}{\% As in the previous section, identification is achieved in two steps: (1)  }\\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabgreen}{\% set the identification scheme mnemonic in the structure VARopt to the  }\\ 
\hspace{1mm}\textcolor{matlabblue}{case} "bq"; (2) run the VARir or VARvd functions.  }\\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabgreen}{\% For the zero long-run restrictions identification, consider the same VAR  }\\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabgreen}{\% as in the previous section. }\\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabgreen}{\%--------------------------------------------------------------------------  }\\ 
\hspace{1mm}\hspace{5mm}  \\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabgreen}{\% 4.1 Load data from Blanchard and Quah }\\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabgreen}{\%--------------------------------------------------------------------------  }\\ 
\hspace{1mm}\hspace{5mm} [xlsdata, xlstext] = xlsread(\textcolor{matlabpurple}{'data/BQ1989\_Data.xlsx'},\textcolor{matlabpurple}{'Sheet1'}); \\ 
\hspace{1mm}\hspace{5mm} dates = xlstext(3:end,1); \\ 
\hspace{1mm}\hspace{5mm} vnames\_long = xlstext(1,2:end); \\ 
\hspace{1mm}\hspace{5mm} vnames = xlstext(2,2:end); \\ 
\hspace{1mm}\hspace{5mm} nvar = length(vnames); \\ 
\hspace{1mm}\hspace{5mm} data   = Num2NaN(xlsdata); \\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabblue}{for} ii=1:length(vnames) \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} DATA.(vnames\{ii\}) = data(:,ii); \\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabblue}{end} \\ 
\hspace{1mm}\hspace{5mm} year = str2double(xlstext\{3,1\}(1:4)); \\ 
\hspace{1mm}\hspace{5mm} quarter = str2double(xlstext\{3,1\}(6)); \\ 
\hspace{1mm}\hspace{5mm} nobs = size(data,1); \\ 
\hspace{1mm}\hspace{5mm}  \\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabgreen}{\% 4.2 Plot series }\\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabgreen}{\%--------------------------------------------------------------------------  }\\ 
\hspace{1mm}\hspace{5mm} FigSize(26,6) \\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabblue}{for} ii=1:nvar \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} subplot(1,2,ii) \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} H(ii) = plot(DATA.(vnames\{ii\}),\textcolor{matlabpurple}{'LineWidth'},3,\textcolor{matlabpurple}{'Color'},cmap(1)); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} title(vnames\_long(ii));  \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} DatesPlot(year+(quarter-1)/4,nobs,6,\textcolor{matlabpurple}{'q'}) \textcolor{matlabgreen}{\% Set the x-axis label  }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} grid on;  \\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabblue}{end} \\ 
\hspace{1mm}\hspace{5mm} SaveFigure(\textcolor{matlabpurple}{'graphics/BQ\_DATA'},1) \\ 
\hspace{1mm}\hspace{5mm} clf(\textcolor{matlabpurple}{'reset'}) \\ 
\hspace{1mm}\hspace{5mm}  \\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabgreen}{\% 5.3 Set up and estimate VAR }\\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabgreen}{\%--------------------------------------------------------------------------  }\\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabgreen}{\% Select endo }\\ 
\hspace{1mm}\hspace{5mm} Xvnames      = \{\textcolor{matlabpurple}{'y'},\textcolor{matlabpurple}{'u'}\}; \\ 
\hspace{1mm}\hspace{5mm} Xvnames\_long = \{\textcolor{matlabpurple}{'GDP growth (Percent)'},\textcolor{matlabpurple}{'Unemployment (Percent)'}\}; \\ 
\hspace{1mm}\hspace{5mm} Xnvar        = length(Xvnames); \\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabgreen}{\% Create matrices of variables \textcolor{matlabblue}{for} the VAR }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} X = nan(nobs,Xnvar); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabblue}{for} ii=1:Xnvar \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} X(:,ii) = DATA.(Xvnames\{ii\}); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabblue}{end} \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% Estimate VAR }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} det = 1; \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} nlags = 8; \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} [VAR, VARopt] = VARmodel(X,nlags,det); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} VARopt.vnames = Xvnames\_long; \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} VARopt.nsteps = 40; \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} VARopt.quality = 1; \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} VARopt.FigSize = [26,8]; \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} VARopt.firstdate = year+(quarter-1)/4; \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} VARopt.frequency = \textcolor{matlabpurple}{'q'}; \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} VARopt.figname= \textcolor{matlabpurple}{'graphics/BQ\_'}; \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm}  \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% 5.4 IMPULSE RESPONSES }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\%--------------------------------------------------------------------------  }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% For zero contemporaneous restrictions set: }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} VARopt.ident = \textcolor{matlabpurple}{'long'}; \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% Compute IR }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} [IR, VAR] = VARir(VAR,VARopt); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% Compute IR error bands }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} [IRinf,IRsup,IRmed,IRbar] = VARirband(VAR,VARopt); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% Plot IR }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} VARirplot(IRbar,VARopt,IRinf,IRsup); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm}  \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% 5.5 REPLICATE FIGURE 1 OF BLANCHARD \& QUAH }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\%--------------------------------------------------------------------------  }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} FigSize(26,8) \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% Plot supply shock }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} subplot(1,2,1) \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} plot(cumsum(IR(:,1,1)),\textcolor{matlabpurple}{'LineWidth'},2.5,\textcolor{matlabpurple}{'Color'},cmap(1)) \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} hold on \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} plot(IR(:,2,1),\textcolor{matlabpurple}{'LineWidth'},2.5,\textcolor{matlabpurple}{'Color'},cmap(2)) \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} hold on \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} plot(zeros(VARopt.nsteps),\textcolor{matlabpurple}{'--k'}) \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} title(\textcolor{matlabpurple}{'Supply shock'}) \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} legend(\{\textcolor{matlabpurple}{'GDP Level'};'Unemployment'\}) \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% Plot demand shock }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} subplot(1,2,2) \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} plot(cumsum(-IR(:,1,2)),\textcolor{matlabpurple}{'LineWidth'},2.5,\textcolor{matlabpurple}{'Color'},cmap(1)) \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} hold on \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} plot(-IR(:,2,2),\textcolor{matlabpurple}{'LineWidth'},2.5,\textcolor{matlabpurple}{'Color'},cmap(2)) \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} hold on \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} plot(zeros(VARopt.nsteps),\textcolor{matlabpurple}{'-k'}) \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} title(\textcolor{matlabpurple}{'Demand shock'}) \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} legend(\{\textcolor{matlabpurple}{'GDP Level'};'Unemployment'\}) \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% Save }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} SaveFigure(\textcolor{matlabpurple}{'graphics/BQ\_Replication'},1); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} clf(\textcolor{matlabpurple}{'reset'}) \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm}  \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\%}\textcolor{matlabgreen}{\% 6. IDENTIFICATION WITH SIGN RESTRICTIONS }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\%**************************************************************************  }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% For the sign restrictions example, consider a larger VAR  with four  }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% endogenous variables. Identification with sign restrictions is achieved  }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% in a slightly different way relative to zero contemporaneous or long-run  }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% restrictions. Identification is achieved in two steps: (1) define a  }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% matrix with the sign restrictions that the IRs have to satisfy; (2) run  }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% the SR function.  }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\%--------------------------------------------------------------------------  }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm}  \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% 6.1 Load data from Uhlig }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\%--------------------------------------------------------------------------  }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} [xlsdata, xlstext] = xlsread(\textcolor{matlabpurple}{'Uhlig2005\_Data.xlsx'},\textcolor{matlabpurple}{'Sheet1'}); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} dates = xlstext(3:end,1); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} vnames\_long = xlstext(1,2:end); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} vnames = xlstext(2,2:end); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} nvar = length(vnames); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} data   = Num2NaN(xlsdata); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabblue}{for} ii=1:length(vnames) \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} DATA.(vnames\{ii\}) = data(:,ii); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabblue}{end} \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} year = str2double(xlstext\{3,1\}(1:4)); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} month = str2double(xlstext\{3,1\}(6)); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} nobs = size(data,1); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% Transform selected variables }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} tempnames = \{\textcolor{matlabpurple}{'y'},\textcolor{matlabpurple}{'pi'},\textcolor{matlabpurple}{'comm'},\textcolor{matlabpurple}{'nbres'},\textcolor{matlabpurple}{'res'}\}; \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} tempscale = [100,100,100,100,100]; \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabblue}{for} ii=1:length(tempnames) \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} DATA.(tempnames\{ii\}) = tempscale(ii)*DATA.(tempnames\{ii\}); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabblue}{end} \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm}  \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% 6.2 Plot series }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\%--------------------------------------------------------------------------  }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% Plot all variables in DATA }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} FigSize(26,18) \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabblue}{for} ii=1:nvar \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} subplot(3,2,ii) \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} H(ii) = plot(DATA.(vnames\{ii\}),\textcolor{matlabpurple}{'LineWidth'},3,\textcolor{matlabpurple}{'Color'},cmap(1)); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} title(vnames\_long(ii));  \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} DatesPlot(year+(month-1)/12,nobs,6,\textcolor{matlabpurple}{'m'}) \textcolor{matlabgreen}{\% Set the x-axis label  }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} grid on;  \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabblue}{end} \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} SaveFigure(\textcolor{matlabpurple}{'graphics/Uhlig\_DATA'},1) \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} clf(\textcolor{matlabpurple}{'reset'}) \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm}  \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% 6.3 Set up and estimate VAR }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\%--------------------------------------------------------------------------  }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% Select endo }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} Xvnames      = vnames; \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} Xvnames\_long = vnames\_long; \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} Xnvar        = length(Xvnames); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% Create matrices of variables \textcolor{matlabblue}{for} the VAR }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} X = nan(nobs,Xnvar); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabblue}{for} ii=1:Xnvar \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} X(:,ii) = DATA.(Xvnames\{ii\}); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabblue}{end} \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% Estimate VAR  }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} det = 1; \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} nlags = 12; \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} [VAR, VARopt] = VARmodel(X,nlags,det); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} VARopt.vnames = Xvnames\_long; \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} VARopt.nsteps = 60; \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} VARopt.ndraws = 500; \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} VARopt.quality = 1; \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} VARopt.FigSize = [26,8]; \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} VARopt.firstdate = year+(month-1)/12; \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} VARopt.frequency = \textcolor{matlabpurple}{'m'}; \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} VARopt.figname= \textcolor{matlabpurple}{'graphics/Uhlig\_'}; \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm}  \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% 6.4 IDENTIFICATION }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\%--------------------------------------------------------------------------  }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% Define the shock names }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} VARopt.snames = \{\textcolor{matlabpurple}{'Mon. Policy Shock'}\}; \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% Define sign restrictions : positive 1, negative -1, unrestricted 0 }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} SIGN = [ 0,0,0,0,0,0;  \textcolor{matlabgreen}{\% Real GDP }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} -1,0,0,0,0,0;  \textcolor{matlabgreen}{\% Deflator }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} -1,0,0,0,0,0;  \textcolor{matlabgreen}{\% Commodity Price }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} 0,0,0,0,0,0;  \textcolor{matlabgreen}{\% Total Reserves }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} -1,0,0,0,0,0;  \textcolor{matlabgreen}{\% NonBorr. Reserves }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} 1,0,0,0,0,0]; \textcolor{matlabgreen}{\% Fed Fund }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% Define the number of steps the restrictions are imposed for: }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} VARopt.sr\_hor = 6; \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% Set options the credible intervals }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} VARopt.pctg = 68; \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% The functin SR performs the sign restrictions identification and computes }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% IRs, VDs, and HDs. All the results are stored in SRout }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} SRout = SR(VAR,SIGN,VARopt); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm}  \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% 6.5 Replicate Uhlig's Figiure 6 }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\%--------------------------------------------------------------------------  }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} FigSize(26,12) \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabblue}{for} ii=1:Xnvar \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} subplot(2,3,ii) \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} PlotSwathe(SRout.IRmed(:,ii,1),[SRout.IRinf(:,ii,1) SRout.IRsup(:,ii,1)]); hold on \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} plot(zeros(VARopt.nsteps),\textcolor{matlabpurple}{'--k'}); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} title(vnames\_long\{ii\}) \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} axis tight \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabblue}{end} \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} SaveFigure(\textcolor{matlabpurple}{'graphics/Uhlig\_Replication'},1) \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} clf(\textcolor{matlabpurple}{'reset'}) \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm}  \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% 6.6 Show what happens in the background }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\%--------------------------------------------------------------------------  }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% Plot all rotations }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} FigSize(26,12) \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabblue}{for} ii=1:Xnvar \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} subplot(2,3,ii) \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} plot(squeeze(SRout.IRall(:,ii,1,:))); hold on \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} plot(zeros(VARopt.nsteps),\textcolor{matlabpurple}{'--k'}); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} title(vnames\_long\{ii\}) \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} axis tight \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} 	store(ii,:) = ylim; \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabblue}{end} \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} SaveFigure(\textcolor{matlabpurple}{'graphics/Uhlig\_Replication\_500rot'},1) \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} clf(\textcolor{matlabpurple}{'reset'}) \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% Plot first rotation }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} FigSize(26,12) \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabblue}{for} ii=1:Xnvar \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} subplot(2,3,ii) \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} plot(SRout.IRall(:,ii,1,1)); hold on \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} plot(zeros(VARopt.nsteps),\textcolor{matlabpurple}{'--k'}); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} title(vnames\_long\{ii\}) \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} axis tight \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} ylim(store(ii,:)) \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabblue}{end} \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} SaveFigure(\textcolor{matlabpurple}{'graphics/Uhlig\_Replication\_1rot'},1) \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} clf(\textcolor{matlabpurple}{'reset'}) \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% Plot first two rotations }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} FigSize(26,12) \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabblue}{for} ii=1:Xnvar \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} subplot(2,3,ii) \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} plot(SRout.IRall(:,ii,1,1)); hold on \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} plot(SRout.IRall(:,ii,1,3)); hold on \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} plot(zeros(VARopt.nsteps),\textcolor{matlabpurple}{'--k'}); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} title(vnames\_long\{ii\}) \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} axis tight \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} ylim(store(ii,:)) \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabblue}{end} \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} SaveFigure(\textcolor{matlabpurple}{'graphics/Uhlig\_Replication\_2rot'},1) \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} clf(\textcolor{matlabpurple}{'reset'}) \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm}  \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm}  \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\%}\textcolor{matlabgreen}{\% 7. IDENTIFICATION WITH EXTERNAL INSTRUMENTS }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\%**************************************************************************  }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% Identification with external instruments is achieved in three steps: (1)  }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% set the identification scheme mnemonic in the structure VARopt to the  }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabblue}{case} "iv"; (2) update the VARopt structure with the  }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% external instrument to be used \textcolor{matlabblue}{for} identification; (3) run the VARir  }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% function. For the external instruments example, we consider the same VAR  }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% as in the sign restrictions example.  }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\%--------------------------------------------------------------------------  }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm}  \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% 7.1 Load data from Gertler and Karadi }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\%--------------------------------------------------------------------------  }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} [xlsdata, xlstext] = xlsread(\textcolor{matlabpurple}{'GK2015\_Data.xlsx'},\textcolor{matlabpurple}{'Sheet1'}); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} dates = xlstext(3:end,1); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} vnames\_long = xlstext(1,2:end); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} vnames = xlstext(2,2:end); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} nvar = length(vnames); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} data   = Num2NaN(xlsdata); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabblue}{for} ii=1:length(vnames) \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} DATA.(vnames\{ii\}) = data(:,ii); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabblue}{end} \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} year = str2double(xlstext\{3,1\}(1:4)); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} month = str2double(xlstext\{3,1\}(6)); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} nobs = size(data,1); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm}  \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% 7.2 Plot series }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\%--------------------------------------------------------------------------  }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% Plot all series in DATA }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} FigSize(26,18) \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabblue}{for} ii=1:nvar \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} subplot(3,2,ii) \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} H(ii) = plot(DATA.(vnames\{ii\}),\textcolor{matlabpurple}{'LineWidth'},3,\textcolor{matlabpurple}{'Color'},cmap(1)); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} title(vnames\_long(ii));  \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} DatesPlot(year+(month-1)/12,nobs,6,\textcolor{matlabpurple}{'m'}) \textcolor{matlabgreen}{\% Set the x-axis label  }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} grid on;  \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabblue}{end} \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} SaveFigure(\textcolor{matlabpurple}{'graphics/GK\_DATA'},1) \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} clf(\textcolor{matlabpurple}{'reset'}) \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm}  \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% 7.3 Set up and estimate VAR }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\%--------------------------------------------------------------------------  }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% Select endo }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} Xvnames\_long = \{\textcolor{matlabpurple}{'1yr T-Bill'};'Consumer Price Index';'Industrial Production';'Excess Bond Premium';\}; \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} Xvnames      = \{\textcolor{matlabpurple}{'gs1'};'logcpi';'logip';'ebp';\}; \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} Xnvar        = length(Xvnames); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% Create matrices of variables \textcolor{matlabblue}{for} the VAR }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} X = nan(nobs,Xnvar); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabblue}{for} ii=1:Xnvar \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} X(:,ii) = DATA.(Xvnames\{ii\}); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabblue}{end} \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% With the usual notation, select the instrument from the DATA structure: }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} IVvnames      = \{\textcolor{matlabpurple}{'ff4\_tc'}\}; \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} IVvnames\_long = \{\textcolor{matlabpurple}{'FF4 futures'}\}; \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} IVnvar        = length(IVvnames); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% Create vector of instruments to be used in the VAR }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} IV = nan(nobs,IVnvar); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabblue}{for} ii=1:IVnvar \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} IV(:,ii) = DATA.(IVvnames\{ii\}); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabblue}{end} \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% Estimate VAR }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} det = 1; \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} nlags = 12; \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} [VAR, VARopt] = VARmodel(X,nlags,det); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} VARopt.vnames = Xvnames\_long; \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} VARopt.nsteps = 60; \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} VARopt.quality = 1; \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} VARopt.FigSize = [26,12]; \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} VARopt.firstdate = year+(month-1)/12; \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} VARopt.frequency = \textcolor{matlabpurple}{'m'}; \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} VARopt.figname= \textcolor{matlabpurple}{'graphics/GK\_'}; \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm}  \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% 7.4 Identification }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\%--------------------------------------------------------------------------  }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% Identification is achieved with the external instrument IV, which needs }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% to be added to the VARopt structure }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} VAR.IV = IV; \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% Update the options in VARopt to be used in IR calculations and plots }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} VARopt.ident = \textcolor{matlabpurple}{'iv'}; \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} VARopt.method = \textcolor{matlabpurple}{'wild'}; \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% Compute IR }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} [IR, VAR] = VARir(VAR,VARopt); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% Compute error bands }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} [IRinf,IRsup,IRmed,IRbar] = VARirband(VAR,VARopt); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% Can now plot the impulse responses with the usual code }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} VARirplot(IRbar,VARopt,IRinf,IRsup); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm}  \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm}  \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% }\textcolor{matlabgreen}{\%}\textcolor{matlabgreen}{\% 8. IDENTIFICATION WITH A MIX OF EXTERNAL INSTRUMENTS AND SIGN RESTRICTIONS }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% }\textcolor{matlabgreen}{\%**************************************************************************  }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% }\textcolor{matlabgreen}{\% Identification with external instruments is achieved in three steps: (1)  }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% }\textcolor{matlabgreen}{\% set the identification scheme mnemonic in the structure VARopt to the  }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabblue}{case} "iv"; (2) update the VARopt structure with the  }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% }\textcolor{matlabgreen}{\% external instrument to be used \textcolor{matlabblue}{for} identification; (3) run the VARir  }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% }\textcolor{matlabgreen}{\% function. For the external instruments example, we consider the same VAR  }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% }\textcolor{matlabgreen}{\% as in the sign restrictions example.  }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% }\textcolor{matlabgreen}{\%--------------------------------------------------------------------------  }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\%  }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% }\textcolor{matlabgreen}{\% First update the VARopt structure with additional details to be used \textcolor{matlabblue}{for} }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% }\textcolor{matlabgreen}{\% the IR calculations and plots }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% VARopt.figname= 'graphics/IVSR\_'; }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\%  }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% }\textcolor{matlabgreen}{\% Define the shock names }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% VARopt.snames = \{'Monetary policy Shock','Demand Shock','Supply Shock','Unidentified'\}; }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\%  }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% }\textcolor{matlabgreen}{\% But now we assume that the first shock is identified with the external  }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% }\textcolor{matlabgreen}{\% instrument. In other words, the first column of the B matrix is given by: }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% disp(VAR.b) }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\%  }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% }\textcolor{matlabgreen}{\% So, we define the sign restrictions only \textcolor{matlabblue}{for} the aggregate demand, the  }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% }\textcolor{matlabgreen}{\% aggregate supply, and the un-identified shock }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% SIGN = [-1,       0,      0;        ... policy rate }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\%         -1,      -1,      0;        ... ip         }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\%         -1,       1,      0;        ... cpi }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\%          1,       1,      0];       ... ebp }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\%        }\textcolor{matlabgreen}{\% D        S       U    }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\%  }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% }\textcolor{matlabgreen}{\% Define the number of steps the restrictions are imposed for: }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% VARopt.sr\_hor = 6; }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\%  }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% }\textcolor{matlabgreen}{\% Set options the credible intervals }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% VARopt.pctg = 95; }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\%  }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% }\textcolor{matlabgreen}{\% The functin SR performs the sign restrictions identification and computes }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% }\textcolor{matlabgreen}{\% IRs, VDs, and HDs. All the results are stored in SRout }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% SRout = SR(VAR,SIGN,VARopt); }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\%  }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% }\textcolor{matlabgreen}{\% Plot impulse responses }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% VARopt.FigSize = [26,24]; }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% SRirplot(SRout.IRmed,VARopt,SRout.IRinf,SRout.IRsup); }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm}  \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm}  \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\%}\textcolor{matlabgreen}{\% }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} m2tex(\textcolor{matlabpurple}{'VARToolbox\_Code.m'}) \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} rmpath(genpath(\textcolor{matlabpurple}{'C:/AMPER/VARToolbox'})) \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm}  \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm} \hspace{5mm}  \\ 
