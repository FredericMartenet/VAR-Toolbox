\hspace{1mm}\textcolor{matlabgreen}{\%}\textcolor{matlabgreen}{\% 1. PRELIMINARIES }\\ 
\hspace{1mm}\textcolor{matlabgreen}{\%--------------------------------------------------------------------------  }\\ 
\hspace{1mm}delete \textcolor{matlabpurple}{'SCREEN.m'}  \\ 
\hspace{1mm}clear all; clear session; close all; clc \\ 
\hspace{1mm}warning off all \\ 
\hspace{1mm}addpath(genpath(\textcolor{matlabpurple}{'C:/AMPER/VARToolbox'})) \\ 
\hspace{1mm}diary \textcolor{matlabpurple}{'SCREEN.m'} \\ 
\hspace{1mm} \\ 
\hspace{1mm} \\ 
\hspace{1mm}\textcolor{matlabgreen}{\%}\textcolor{matlabgreen}{\% 1. LOAD \& PLOT DATA }\\ 
\hspace{1mm}\textcolor{matlabgreen}{\%--------------------------------------------------------------------------  }\\ 
\hspace{1mm}\textcolor{matlabgreen}{\% Load  }\\ 
\hspace{1mm}[xlsdata, xlstext] = xlsread(\textcolor{matlabpurple}{'GK2015\_Data.xlsx'},\textcolor{matlabpurple}{'VAR\_data'}); \\ 
\hspace{1mm}data   = Num2NaN(xlsdata(:,3:end)); \\ 
\hspace{1mm}vnames = xlstext(1,3:end); \\ 
\hspace{1mm}\textcolor{matlabblue}{for} ii=1:length(vnames) \\ 
\hspace{1mm}\hspace{5mm} DATA.(vnames\{ii\}) = data(:,ii); \\ 
\hspace{1mm}\textcolor{matlabblue}{end} \\ 
\hspace{1mm}year = xlsdata(1,1); \\ 
\hspace{1mm}month = xlsdata(1,2); \\ 
\hspace{1mm}\textcolor{matlabgreen}{\% Observations }\\ 
\hspace{1mm}nobs = size(data,1); \\ 
\hspace{1mm}\textcolor{matlabgreen}{\% Set endogenous }\\ 
\hspace{1mm}VARvnames      = \{\textcolor{matlabpurple}{'gs1'},\textcolor{matlabpurple}{'logcpi'},\textcolor{matlabpurple}{'logip'},\textcolor{matlabpurple}{'ebp'}\}; \\ 
\hspace{1mm}VARvnames\_long = \{\textcolor{matlabpurple}{'Policy rate'},\textcolor{matlabpurple}{'CPI'},\textcolor{matlabpurple}{'Industrial Production'},\textcolor{matlabpurple}{'EBP'}\}; \\ 
\hspace{1mm}VARnvar        = length(VARvnames); \\ 
\hspace{1mm}\textcolor{matlabgreen}{\% Create matrices of variables \textcolor{matlabblue}{for} the VAR }\\ 
\hspace{1mm}\hspace{5mm} ENDO = nan(nobs,VARnvar); \\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabblue}{for} ii=1:VARnvar \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} ENDO(:,ii) = DATA.(VARvnames\{ii\}); \\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabblue}{end} \\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabgreen}{\% Open a figure of the desired size }\\ 
\hspace{1mm}\hspace{5mm} FigSize(28,16) \\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabblue}{for} ii=1:VARnvar \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} subplot(2,2,ii) \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} H(ii) = plot(ENDO(:,ii),\textcolor{matlabpurple}{'LineWidth'},2,\textcolor{matlabpurple}{'Color'},cmap(ii)); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} title(VARvnames\_long(ii));  \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} DatesPlot(year+(month-1)/12,nobs,6,\textcolor{matlabpurple}{'m'}) \textcolor{matlabgreen}{\% Set the x-axis label  }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} ylabel(\textcolor{matlabpurple}{'Percent'}); grid on;  \\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabblue}{end} \\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabgreen}{\% Legend }\\ 
\hspace{1mm}\hspace{5mm} lopt = LegOption; lopt.handle = H; LegSubplot(VARvnames,lopt); FigFont(10); \\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabgreen}{\% Save  }\\ 
\hspace{1mm}\hspace{5mm} SaveFigure(\textcolor{matlabpurple}{'graphics/F1\_PLOT'},1) \\ 
\hspace{1mm}\hspace{5mm}  \\ 
\hspace{1mm}\hspace{5mm}  \\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabgreen}{\%}\textcolor{matlabgreen}{\% VAR ESTIMATION }\\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabgreen}{\%--------------------------------------------------------------------------  }\\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabgreen}{\% Set the deterministic variable in the VAR (1=constant, 2=trend) }\\ 
\hspace{1mm}\hspace{5mm} det = 1; \\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabgreen}{\% Set number of nlags }\\ 
\hspace{1mm}\hspace{5mm} nlags = 12; \\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabgreen}{\% Estimate VAR by OLS }\\ 
\hspace{1mm}\hspace{5mm} [VAR, VARopt] = VARmodel(ENDO,nlags,det); \\ 
\hspace{1mm}\hspace{5mm} disp(VAR) \\ 
\hspace{1mm}\hspace{5mm} disp(VARopt) \\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabgreen}{\% Add variable names to VARopt }\\ 
\hspace{1mm}\hspace{5mm} VARopt.vnames = VARvnames; \\ 
\hspace{1mm}\hspace{5mm} VARopt.figname= \textcolor{matlabpurple}{'graphics/'}; \\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabgreen}{\% Print at screen and create table }\\ 
\hspace{1mm}\hspace{5mm} [TABLE, beta] = VARprint(VAR,VARopt,2); \\ 
\hspace{1mm}\hspace{5mm}  \\ 
\hspace{1mm}\hspace{5mm}  \\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabgreen}{\%}\textcolor{matlabgreen}{\% IMPULSE RESPONSES: ZERO SHORT-RUN RESTRICTIONS }\\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabgreen}{\%--------------------------------------------------------------------------  }\\ 
\hspace{1mm}\hspace{5mm} \textcolor{matlabgreen}{\% Set options some options \textcolor{matlabblue}{for} IR calculation }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} VARopt.nsteps = 40; \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} VARopt.ident = \textcolor{matlabpurple}{'oir'}; \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} VARopt.quality = 1; \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% Compute IR }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} [IR, VAR] = VARir(VAR,VARopt); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% Compute error bands }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} [IRinf,IRsup,IRmed,IRbar] = VARirband(VAR,VARopt); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% Plot }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} VARirplot(IRbar,VARopt,IRinf,IRsup); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm}  \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm}  \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\%}\textcolor{matlabgreen}{\% FORECAST ERROR VARIANCE DECOMPOSITION: ZERO SHORT-RUN RESTRICTIONS }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\%--------------------------------------------------------------------------  }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% Compute VD }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} [VD, VAR] = VARvd(VAR,VARopt); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% Compute error bands }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} [VDinf,VDsup,VDmed,VDbar] = VARvdband(VAR,VARopt); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% Plot }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} VARvdplot(VDbar,VARopt); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm}  \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm}  \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\%}\textcolor{matlabgreen}{\% HISTORICAL DECOMPOSITION: ZERO SHORT-RUN RESTRICTIONS }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\%--------------------------------------------------------------------------  }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% Compute HD }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} HD = VARhd(VAR); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% Add dates to VARopt  }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} VARopt.firstdate = year+(month-1)/12; \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} VARopt.frequency = \textcolor{matlabpurple}{'m'}; \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% Plot HD }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} VARhdplot(HD,VARopt); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm}  \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm}  \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\%}\textcolor{matlabgreen}{\% IMPULSE RESPONSES: SIGN RESTRICTIONS }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\%--------------------------------------------------------------------------  }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% Set options some options \textcolor{matlabblue}{for} IR calculation }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} VARopt.snames = \{\textcolor{matlabpurple}{'Demand Shock'},\textcolor{matlabpurple}{'Supply Shock'},\textcolor{matlabpurple}{'Monetary Policy Shock'},\textcolor{matlabpurple}{'Unidentified'}\}; \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} VARopt.pctg = 68; \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% Define signs matrix }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\%     demand    supply   monpol  un-identified }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} SIGN = [-1,       0,       1      0;        ... policy rate \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} -1,       1,      -1      0;        ... cpi \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} -1,      -1,      -1      0;        ... ip \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} 1,       1,       1      0;        ... ebp \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} ]; \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% Compute sign restrictions }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} SRout = SR(VAR,SIGN,VARopt); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% Plot impulse responses }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} SRirplot(SRout.IRmed,VARopt,SRout.IRinf,SRout.IRsup); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% Plot variance decompositions }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} SRvdplot(SRout.VDmed,VARopt); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% Plot hd }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} SRhdplot(SRout.HDmed,VARopt); \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm}  \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm}  \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\%}\textcolor{matlabgreen}{\% }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} diary off \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} m2tex(\textcolor{matlabpurple}{'SCREEN.m'}) \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} m2tex(\textcolor{matlabpurple}{'VAR\_TOOLBOX.m'}) \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm} \textcolor{matlabgreen}{\% rmpath(genpath('C:/AMPER/VARToolbox')) }\\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm}  \\ 
\hspace{1mm}\hspace{5mm} \hspace{5mm} \hspace{5mm}  \\ 
